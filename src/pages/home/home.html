<ion-header>
  <ion-navbar>
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-label float-left="">Home</ion-label>
    <ion-label float-right>{{getUserData("full_name")}}</ion-label>
    <ion-icon float-right name="{{isConnected() ? 'cloud' : 'thunderstorm'}}"></ion-icon>
  </ion-navbar>
</ion-header>


<ion-content>
  <div *ngIf="isUserAuthenticated(); then authenticatedBlock else unknownUserBlock"></div>
</ion-content>

<ion-footer>
  Footer
</ion-footer>

<!--The login block for unauthenticated users-->
<ng-template #unknownUserBlock>
  <div *ngIf="presentLogoutScreen; then logoutBlock else loginBlock"></div>
</ng-template>


<ng-template #loginBlock>
  <div class="header">
    <ion-grid>
      <ion-row>
        <ion-col>
          <h1>Traccia GSI</h1>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          <page-login></page-login>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ng-template>

<ng-template #logoutBlock>
  <div class="header">
    <ion-grid text-center>
      <ion-row>
        <ion-col>
          <h1>Arrivederci {{logoutScreenData.name}}</h1>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          <img src="assets/image/face.png">
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          <p>Hai segnalato la tua uscita.</p>
          <p>Oggi {{logoutScreenData.date}} hai lavorato<br />
            {{logoutScreenData.duration}}.
          </p>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ng-template>



<!--The block to use to show current status-->
<ng-template #authenticatedBlock>
  <div *ngIf="isUserCheckedIn(); then checkedIn else checkedOut"></div>
</ng-template>

<!-- The block for checked OUT user -->
<ng-template #checkedOut>
  <div class="header">
    <ion-fab top right class="qr-scan-fab">
      <button ion-fab color="yellow-light" (tap)="scanQRCode('IN')">
        <ion-icon ios="md-qr-scanner" md="md-qr-scanner"></ion-icon>
      </button>
    </ion-fab>

    <ion-grid>
      <ion-row>
        <ion-col>
          <h3>
            <ion-label color="lightest">Ciao {{getUserData("first_name") || getUserData("name")}}!</ion-label>
          </h3>
          <p>Bentornato!</p>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <div class="main">
    <ion-grid>
      <ion-row>
        <ion-col>
          <p>Scansiona il <strong>QRcode d'ingresso</strong> per iniziare la tua giornata lavorativa.</p>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ng-template>


<!-- The block for checked IN user -->
<ng-template #checkedIn>
  <div class="header">
    <ion-fab top right class="qr-scan-fab">
      <button ion-fab color="yellow-light" (tap)="scanQRCode('CHK')">
        <ion-icon name="qr-scanner"></ion-icon>
      </button>
    </ion-fab>

    <ion-fab top right class="qr-scan-fab exit" *ngIf="!isMobileDevice()">
      <button ion-fab mini color="danger" (tap)="scanQRCode('OUT')">
        <ion-icon ios="md-qr-scanner" md="md-qr-scanner"></ion-icon>
      </button>
    </ion-fab>

    <ion-grid>
      <ion-row>
        <ion-col>
          <p>Stai lavorando da</p>
          <h3>
            <ion-label color="lightest">
              {{shiftTotalDuration}}
            </ion-label>
          </h3>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <div class="main"><ion-grid>
    <ion-row>
      <ion-col>
        <h5>Scansiona il <strong>QRcode dell'ambiente</strong> da pulire</h5>
      </ion-col>
    </ion-row>
  </ion-grid>


    <ion-grid class="checkin_list">
      <ion-row *ngFor="let checkin of remoteDataService.getAllCheckinsReversed()" ngClass="{{checkin.css_class}}">
        <ion-col col-10>
          <div>
            <ion-icon [name]="checkin.icon" item-left></ion-icon>
            {{checkin.name}} ({{checkin.duration}})
          </div>
        </ion-col>
        <ion-col col-2 text-right="">
          <div>
            {{checkin.getFormattedTime()}}
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ng-template>







